<!-- Game board -->
<div class="layer">
	<div game-map
		ng-if="!map.state.isUnavailable()"
		options="map.options"
		current="current.location"
		selected="locations.selected">
	</div>
</div>
<!-- end game board -->

<!-- Intro page stuff -->
<div ng-if="current.state.isIntro()">

	<!-- ANZ World map -->
	<div class="layer overlay intro-screen"></div>

	<div class="layer spin-wheel" style="left: -100px; top: -117px;">
		<img src="images/anz_flower_animation_white_big.png" height="314" width="314" />
	</div>
	<div class="layer spin-wheel" style="right: -157px; bottom: -157px;">
		<img src="images/anz_flower_animation_blue_big.png" height="314" width="314" />
	</div>

	<!-- Game buttons -->
	<div class="layer intro-buttons">

		<!-- Play button -->
		<button type="button" class="btn btn-lg btn-primary btn-menu" ng-click="game.menu(true)">Play</button>

		<!-- Options button -->
		<button type="button" class="btn btn-lg btn-primary btn-menu">Options</button>

		<!-- Journal button -->
		<button type="button" class="btn btn-lg btn-primary btn-menu" ng-click="journal.isOpen = true">Journal</button>

	</div>
	<!-- end game buttons -->

</div>
<!-- end intro page -->

<!-- Menu page stuff -->
<div ng-if="current.state.isMenu()">

	<!-- Sidebar for more settings -->
	<div class="layer sidebar top-gap">
		<div accordion close-others="'true'">

			<!-- Pre-configs -->
			<div accordion-group heading="Play for fun (easy)" ng-click="settings.setConfig('easy')">
				<p>Play the game at an easy difficulty.</p>
				<h4>Budget: ${{ settings.budget | number }}</h4>
				<h4>Days of travel: {{ settings.travelDays }}</h4>
			</div>
			<div accordion-group heading="I like to shop! (medium)" ng-click="settings.setConfig('medium')">
				<p>Try to collect as many souvenirs as possible!</p>
				<h4>Budget: ${{ settings.budget | number }}</h4>
				<h4>Days of travel: {{ settings.travelDays }}</h4>
			</div>
			<div accordion-group heading="Go backpacking (hard)" ng-click="settings.setConfig('hard')">
				<p>Test your mettle over a long trip on a shoe-string budget.</p>
				<h4>Budget: ${{ settings.budget | number }}</h4>
				<h4>Days of travel: {{ settings.travelDays }}</h4>
			</div>
			<!-- end of pre-configs -->

			<!-- Initial configuration -->
			<div accordion-group heading="My Travel Plan" is-open="true" ng-click="settings.setConfig('custom')">
				<form>

					<!-- Budget -->
					<div class="form-group">
						<label for="menu-budget">My budget</label>
						<div class="input-group">
							<span class="input-group-addon">$</span>
							<input type="number" id="menu-budget" class="form-control" ng-model="settings.budget" min="100" step="100"
							required />
						</div>
					</div>
					<!-- end of budget -->

					<!-- Days of travel -->
					<div class="form-group">
						<label for="menu-days">Days Travelling</label>
						<input type="number" id="menu-days" class="form-control" ng-model="settings.travelDays" min="1" step="1"
						required />
					</div>
					<!-- end of days -->

				</form>
			</div>
			<!-- end of initial config -->

		</div>
	</div>
	<!-- end settings sidebar -->

	<!-- Start game button -->
	<div class="layer button-next" ng-class="getTimeOfDay()">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="game.start()">
			Start
		</button>
	</div>
	<!-- end start button -->

	<!-- Selected destination -->
	<div class="layer menu-top-bar banner-bar">
		<h1 class="banner">Destination: {{ current.location.name }}</h1>
		<h1 class="banner delayed">Destination: {{ current.location.name }}</h1>
	</div>
	<!-- end selected destination -->

</div>
<!-- end menu page -->

<!-- Play page -->
<div ng-if="current.state.isPlaying()">

	<!-- Alerts container -->
	<div widget-alert="alertMessage" chevron="down" class="layer animated"
		ng-class="getTimeOfDay()"
		state-tracker="alert"
		state-choices="[
			{state: 'off', set: 'reset', check: 'isOff'}
			, {state: 'on', set: 'show', check: 'isOn'}
			, {state: 'dismissed', set: 'dismiss', check: 'isDismissed'}
		]"
		state-class="['hide', 'bounceInUp', 'bounceOutUp']"
		state-transition="{dismissed: {off: 1000}}">
	</div>
	<!-- end alerts -->

		<!-- ng-show="locations.selected && map.options.selectable == 'location'" -->
	<!-- Selected landmark card -->
	<div landmark-card
		ng-repeat="landmark in locations.landmarks"
		landmark="landmark"
		ng-show="(locations.selected.id === landmark.id) && (map.options.selectable === 'location') && !landmark.isCardClosed"
		class="layer"
		ng-class="[getTimeOfDay(), 'stacked-card-' + $index]">
	</div>
	<!-- end landmark card -->

	<!-- Landmark view -->
	<div landmark-view landmark="current.location" class="layer overlay"
		ng-if="current.location && turnState.isActive()">
	</div>

	<!-- Resource indicators -->
	<div class="layer">
		<div widget-resource-indicator type="MONEY" category="ALL" resources="resources"></div>
		<div widget-resource-indicator type="XP" category="ALL" resources="resources"></div>
		<div widget-resource-indicator type="SOUVENIR" category="ALL" resources="resources"></div>
	</div>
	<!-- Time indicators -->
	<div widget-day-counter day="getDay()" class="layer" ng-if="getDay() && !turnState.isActive()"></div>
	<!-- end indicators -->

	<!-- Ungrades unlocked -->
	<div class="layer upgrade-indicators">
		<span class="upgrade-indicator" ng-repeat="upgrade in upgrades" ng-show="upgrade.isUnlocked"
			tooltip="Unlocked: {{ upgrade.name }}" tooltip-placement="bottom">
			<img ng-src="{{ upgrade.icon }}" />
		</span>
		<span class="journal-icon" ng-click="journal.isOpen = true"
			tooltip="View your Journal" tooltip-placement="bottom">
			<img ng-src="images/upgrades/books-icon.png" height="48" />
		</span>
	</div>
	<!-- end upgrades -->

	<!-- Sidebar for turn options -->
	<div class="layer sidebar turn-options"
		ng-class="getTimeOfDay()"
		ng-if="turnState.isActive()">

		<h2>
			<span ng-if="!current.location.isVisited()">Welcome!</span>
			<span ng-if="current.location.isVisited()">Welcome back!</span>
			What would you like to do here?
		</h2>

		<div accordion close-others="'true'">

			<!-- Shopping option -->
			<div accordion-group heading="Shopping" is-open="true">
				<div class="souvenir picture">
					<img class="img-responsive" ng-src="{{ current.location.shopping.image }}" width="128" height="128" />
				</div>
				<div class="souvenir info">
					<h4>{{ current.location.shopping.name }}</h4>
					<div class="souvenir cost">
						<img src="images/icons/anz_icon_ui_money_tiny.png" height="36" width="23" />
						{{ current.location.shopping.cost }}
					</div>
					<div class="souvenir gains">
						<img src="images/icons/anz_icon_ui_shopping_tiny.png" height="36" width="30" />
						{{ current.location.shopping.souvenirs }}
					</div>
				</div>
				<div class="clearfix"></div>

				<small>{{ current.location.shopping.description }}</small>

				<div class="action">
					<button type="button"
						class="btn btn-default"
						ng-click="shoppingState.isAvailable() ? game.shop() : null"
						ng-disabled="!shoppingState.isAvailable || !game.canShop()"
						state-tracker="shoppingState"
						state-choices="[
							{state: 'available', set: 'reset', check: 'isAvailable'}
							, {state: 'purchasing', set: 'purchase', check: 'isPurchasing'}
							, {state: 'bought', set: 'markBought', check: 'hasBought'}
						]"
						state-class="['btn-default', 'animated flash btn-warning', 'btn-warning']"
						state-transition="{purchasing: {bought: 1000}}">
						{{ whyCantI(game.canShop) || (shoppingState | stateTracker:"Buy this item!":"Bought it!":"Bought it!") }}
					</button>
				</div>
			</div>
			<!-- end shopping option -->

			<!-- Optional features -->
			<div accordion-group heading="Activites">
	 			<div ng-repeat="bonus in current.location.bonuses track by $index" ng-if="bonus.type === 'activity'">
	 				<div ng-switch on="bonus.activityType">
	 					<div ng-switch-when="gambling">
							<h4>{{ bonus.flavour }}</h4>
							<p>Bet for double or nothing:</p>
							<button type="button" class="btn btn-default" ng-click="activities.gamble(50)" ng-disabled="activities.outcome">$50</button>
							<button type="button" class="btn btn-default" ng-click="activities.gamble(100)" ng-disabled="activities.outcome">$100</button>
							<button type="button" class="btn btn-default" ng-click="activities.gamble(200)" ng-disabled="activities.outcome">$200</button>
							<h4 class="alert alert-warning animated lightSpeedIn" ng-show="activities.outcome">{{ activities.outcome }}</h4>
						</div>
					</div>
				</div>
			</div>
			<!-- end optional features -->

		</div>
		<!-- end things to show in current turn -->

	</div>
	<!-- end turn sidebar -->

	<!-- Start game button -->
	<div class="layer button-next" ng-class="getTimeOfDay()" ng-if="!current.location">
		<button type="button"
			class="btn btn-lg btn-warning btn-action animated"
			ng-click="game.setStartPoint()"
		 	ng-disabled="!locations.selected"
		 	ng-class="locations.selected ? 'bounce' : 'fadeIn'">
			<span ng-if="!locations.selected">Select your start point.</span>
			<span ng-if="locations.selected">Let's begin!</span>
		</button>
	</div>
	<!-- end start button -->

	<!-- Start turn button -->
	<div class="layer button-next" ng-class="getTimeOfDay()" ng-if="!turnState.isActive() && current.location">
		<button type="button"
			class="btn btn-lg btn-warning btn-action animated"
			ng-click="game.startTurn()"
			ng-disabled="!game.canPlay()"
			ng-class="game.canPlay() ? 'bounce' : 'fadeIn'">
			{{ whyCantI(game.canPlay) || "Go!" }}
		</button>
	</div>
	<!-- end start button -->

	<!-- End turn button -->
	<div class="layer button-next" ng-class="getTimeOfDay()" ng-if="turnState.isActive() && current.location">
		<button type="button"
			class="btn btn-lg btn-info btn-action"
			ng-click="game.endTurn()">
			End Turn
		</button>
	</div>
	<!-- end end-turn button -->

	<!-- Menu button -->
<!--  	<div class="layer button-prev" ng-class="getTimeOfDay()">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="game.menu()">
			<i class="fa fa-long-arrow-left"></i>
		</button>
	</div> -->
	<!-- end menu button -->

	<!-- Random event card -->
	<div ng-show="randomEvent">
		<div random-event-card random-event="randomEvent" class="layer overlay"></div>
	</div>
	<!-- end event card -->

	<!-- Upgrade unlocked event card -->
	<div ng-show="upgradeUnlocked">
		<div upgrade-card upgrade="upgradeUnlocked" class="layer overlay"></div>
	</div>
	<!-- end upgrade card -->

</div>
<!-- end play page -->

<!-- Stats page at the end -->
<div ng-if="current.state.isStats()">

	<!-- Chart -->
	<div class="layer overlay stats-chart">
		<highchart id="resultsChart_money" config="chartConfig_money"></highchart>
		<highchart id="resultsChart_xp" config="chartConfig_xp"></highchart>
		<highchart id="resultsChart_souvenirs" config="chartConfig_souvenirs"></highchart>
	</div>
	<!-- end chart -->

	<!-- Score computation -->
	<div class="layer sidebar top-gap text-center">

		<div class="stats-score">
			<img class="pull-left" src="images/icons/anz_icon_ui_money_small.png" height="64" width="64" />

			<!-- Funds -->
			<h2>${{ resources.get(resources.categories.ALL, resources.types.MONEY) | number }}</h2>
			<p>funds left</p>

			<small class="text-right">
				<p>Initial budget: ${{ settings.budget | number }}</p>
				<p>Savings: {{ getSavings() | number }}</p>
			</small>
		</div>
		<div class="stats-score">
			<img class="pull-left" src="images/icons/anz_icon_ui_star_small.png" height="64" width="64" />

			<!-- Experience -->
			<h2>{{ resources.get(resources.categories.ALL, resources.types.XP) | number }}</h2>
			<p>experience gained</p>

			<small class="text-right">
				<p>{{ getVisitsCount() }} landmarks visited</p>
			</small>
		</div>
		<div class="stats-score">
			<img class="pull-left" src="images/icons/anz_icon_ui_shopping_small.png" height="64" width="64" />

			<!-- Shopping -->
			<h2>{{ resources.get(resources.categories.ALL, resources.types.SOUVENIR) | number }}</h2>
			<p>souvenirs purchased</p>
		</div>
		<div class="stats-score stats-total">
			<!-- Total -->
			<h3>Your score:</h3>
			<h1>
				{{ ( resources.get(
						resources.categories.ALL
						, resources.types.MONEY
					) * 1
				) + ( resources.get(
						resources.categories.ALL
						, resources.types.XP
					) * 100
				) + ( resources.get(
						resources.categories.ALL
						, resources.types.SOUVENIR
					) * 100
				) | number }}
			</h1>
		</div>

	</div>
	<!-- end settings sidebar -->

	<!-- Restart game button -->
	<div class="layer button-next">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="game.menu()">
			Play again!
		</button>
	</div>
	<!-- end restart button -->

	<!-- Selected destination -->
	<div class="layer menu-top-bar">
		<h1>
			<div class="pull-right">
				<span class="journal-icon" ng-click="journal.isOpen = true">
					<img src="images/upgrades/books-icon.png" height="48" />
				</span>
				<span class="evening">
					<button class="btn btn-xs btn-action">Post on Facebook</button>
				</span>
				<span class="morning">
					<button class="btn btn-xs btn-action">Post on Twitter</button>
				</span>
			</div>

			Results
		</h1>
	</div>
	<!-- end selected destination -->

</div>
<!-- end stats page -->

<!-- Traveller's Journal page -->
<div class="layer overlay journal" ng-if="journal.isOpen" ng-controller="JournalCtrl">

	<div class="menu-top-bar">
		<h1>Traveller's Journal</h1>
	</div>

	<div class="journal-option journal-landmark-option" ng-click="journal.showLandmarks = true" >
		<img src="images/landmarks/anz_icon_card_back.png" height="634" width="412" />
		<h2>{{ getVisitedLandmarks() }} / {{ getTotalLandmarks() }}</h2>
	</div>
	<div class="journal-option journal-items-option" ng-click="journal.showItems = true" >
		<img src="images/items/anz_icon_card_item.png" height="642" width="420" />
		<h2>{{ getBoughtItems() }} / {{ getTotalItems() }}</h2>
	</div>

	<!-- Back button -->
	<div class="layer button-prev">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="journal.isOpen = false">
			<i class="fa fa-long-arrow-left"></i> Back
		</button>
	</div>
	<!-- end back button -->

	<!-- Landmarks subpage -->
	<div class="layer overlay journal-page" ng-if="journal.showLandmarks">

		<!-- Zoom in the selected landmark card -->
		<div class="journal-page-half journal-zoom">

			<!-- Selected landmark card -->
			<div landmark-card
				landmark="journal.selectedLandmark"
				ng-if="journal.selectedLandmark"
				class="layer">
			</div>
			<!-- end landmark card -->

			<h1 ng-if="!journal.selectedLandmark">
				Select a landmark you've visited
				<br />
				&rarr;

				<!-- Social shares -->
				<br /><br />
				<h4 class="text-info">Share your achievements:</h4>
				<span class="evening">
					<button class="btn btn-xs btn-action">Post on Facebook</button>
				</span>
				<span class="morning">
					<button class="btn btn-xs btn-action">Post on Twitter</button>
				</span>

			</h1>

		</div>
		<div class="journal-page-half journal-list">

			<div landmark-card
				ng-repeat="landmark in locations.landmarks"
				landmark="landmark"
				ng-click="journal.selectedLandmark = (landmark.isVisited() ? landmark : null)"
				class="journal-landmark-card-thumbnail"
				ng-class="{ unavailable: !landmark.isVisited() }">
			</div>

		</div>
	</div>

	<!-- Back button -->
	<div class="layer button-prev" ng-if="journal.showLandmarks">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="journal.showLandmarks = false">
			<i class="fa fa-long-arrow-left"></i> Back
		</button>
	</div>
	<!-- end back button -->

	<!-- Items subpage -->
	<div class="layer overlay journal-page" ng-if="journal.showItems">

		<!-- Zoom in the selected item card -->
		<div class="journal-page-half journal-zoom">

			<!-- Selected item card -->
			<div item-card
				item="journal.selectedItem"
				ng-if="journal.selectedItem"
				class="layer">
			</div>
			<!-- end item card -->

			<h1 ng-if="!journal.selectedItem">
				Select an item you've purchased
				<br />
				&rarr;

				<!-- Social shares -->
				<br /><br />
				<h4 class="text-info">Share your achievements:</h4>
				<span class="evening">
					<button class="btn btn-xs btn-action">Post on Facebook</button>
				</span>
				<span class="morning">
					<button class="btn btn-xs btn-action">Post on Twitter</button>
				</span>

			</h1>

		</div>
		<div class="journal-page-half journal-list">

			<div class="journal-item-card-thumbnail" ng-repeat="landmark in locations.landmarks"
				ng-class="{ unavailable: !hasBought(landmark.shopping) }"
				ng-click="journal.selectedItem = (hasBought(landmark.shopping) ? landmark.shopping : null)">
				<h3>{{ landmark.shopping.name }}</h3>
				<img class="img-responsive" ng-src="{{ landmark.shopping.image }}" width="128" height="128" />
			</div>

		</div>
	</div>

	<!-- Back button -->
	<div class="layer button-prev" ng-if="journal.showItems">
		<button type="button" class="btn btn-lg btn-primary btn-action" ng-click="journal.showItems = false">
			<i class="fa fa-long-arrow-left"></i> Back
		</button>
	</div>
	<!-- end back button -->


</div>
<!-- end stats page -->

<!-- Loading/splash screen -->
<div class="layer overlay loading"
	state-tracker="loadingState"
	state-transition="{active: {complete: 500}, complete: {failed: 500}}"
	state-class="['', 'animated fadeIn animated-fast', 'animated fadeOut', 'hide']">
	<div loading></div>
</div>

